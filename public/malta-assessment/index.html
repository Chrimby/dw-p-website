<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malta Eignungscheck - Dr. Werner & Partner</title>
    <meta name="description" content="Finden Sie heraus, ob Malta der richtige Standort für Sie ist. 12-14 Fragen für Ihre personalisierte Analyse.">

    <!-- Adobe Fonts (Typekit) - Dr. Werner & Partners Brand Fonts -->
    <link rel="stylesheet" href="https://use.typekit.net/lsl4kqd.css">

    <style>
        /* CSS Custom Properties - Dr. Werner & Partners Brand */
        :root {
            /* Brand Colors */
            --color-primary: #1b1b3f;      /* Dark navy blue - brand primary */
            --color-secondary: #2c2c2c;    /* Dark gray - body text */
            --color-accent: #70dcc4;       /* Turquoise/mint - highlights */

            --color-white: #ffffff;
            --color-black: #1b1b3f;        /* Use brand primary as "black" */

            /* Gray Scale */
            --color-gray-50: #fafafa;
            --color-gray-100: #f5f5f5;
            --color-gray-200: #e5e5e5;
            --color-gray-300: #d4d4d4;
            --color-gray-400: #a3a3a3;
            --color-gray-500: #666666;
            --color-gray-600: #525252;
            --color-gray-700: #404040;
            --color-gray-800: #2c2c2c;     /* Brand secondary */
            --color-gray-900: #1b1b3f;     /* Brand primary */

            /* Semantic Colors */
            --color-primary-strong: #141433;  /* Darker navy for emphasis */
            --color-highlight: var(--color-accent);
            --color-success: #22c55e;
            --color-warning: #eab308;
            --color-danger: #ef4444;

            /* Typography - Brand Fonts */
            --font-heading: "calluna", serif;          /* Serif for headings */
            --font-body: "calluna-sans", sans-serif;   /* Sans for body */
            --font-base: var(--font-body);

            /* Design System */
            --radius: 12px;
            --border: 1px solid var(--color-gray-200);
        }

        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-base);
            background: transparent;
            color: var(--color-black);
            line-height: 1.6;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Typography */
        h1, h2, h3, h4 {
            font-family: var(--font-heading);
            font-weight: 600;
            line-height: 1.2;
            letter-spacing: -0.025em;
        }

        h1 {
            font-size: clamp(2rem, 4vw, 2.5rem);
        }

        h2 {
            font-size: clamp(1.5rem, 3vw, 2rem);
        }

        h3 {
            font-size: clamp(1.125rem, 2vw, 1.5rem);
        }

        h4 {
            font-size: 1.125rem;
        }

        /* Container */
        .container {
            max-width: 760px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        .container-wide {
            max-width: 1120px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        /* Progress Bar */
        .progress-wrapper {
            position: relative;
            z-index: 5;
            padding: 1.5rem 0 1rem;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(6px);
            border-bottom: 1px solid rgba(10, 10, 10, 0.06);
        }

        .progress-container {
            max-width: 920px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: grid;
            gap: 0.45rem;
        }

        .progress-overall-track {
            position: relative;
            height: 6px;
            background: rgba(10, 10, 10, 0.08);
            border-radius: 999px;
            overflow: hidden;
        }

        .progress-overall-fill {
            height: 100%;
            background: var(--color-highlight);
            border-radius: inherit;
            transition: width 0.35s ease;
            box-shadow: 0 0 0 rgba(112, 220, 196, 0);
        }

        .progress-labels {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.82rem;
            color: rgba(17, 17, 17, 0.6);
        }

        .progress-labels strong {
            font-size: 0.88rem;
            color: var(--color-primary-strong);
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            margin-top: 2rem;
            min-height: calc(100vh - 200px);
        }

        /* Welcome Screen */
        .welcome-shell {
            padding: 4rem 0 6rem;
        }

        .welcome-screen {
            position: relative;
            display: grid;
            gap: 2.5rem;
            padding: 3.25rem;
            border-radius: calc(var(--radius) * 2.4);
            background: rgba(255, 255, 255, 0.98);
            border: 1px solid rgba(17, 17, 17, 0.08);
            box-shadow: 0 36px 95px rgba(10, 10, 10, 0.14);
            overflow: hidden;
        }

        .welcome-content {
            display: grid;
            gap: 1.5rem;
        }

        .welcome-title {
            font-size: clamp(1.75rem, 3.5vw, 2.5rem);
            font-weight: 600;
            color: var(--color-black);
            line-height: 1.15;
            margin: 0;
        }

        .welcome-text {
            font-size: 1.125rem;
            color: var(--color-gray-700);
            line-height: 1.7;
            max-width: 650px;
        }

        .welcome-features {
            display: grid;
            gap: 0.875rem;
            list-style: none;
            padding: 0;
            margin: 1.5rem 0 0;
        }

        .welcome-features li {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1rem;
            color: var(--color-gray-700);
        }

        .welcome-features li::before {
            content: "";
            width: 10px;
            height: 10px;
            border-radius: 999px;
            background: var(--color-black);
            box-shadow: 0 0 0 4px rgba(112, 220, 196, 0.35);
            flex-shrink: 0;
        }

        .btn-primary {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.6rem;
            padding: 1.125rem 2.5rem;
            font-size: 1.0625rem;
            font-weight: 500;
            font-family: var(--font-base);
            background: var(--color-black);
            color: var(--color-white);
            border: none;
            border-radius: calc(var(--radius) * 1.4);
            cursor: pointer;
            transition: transform 0.18s ease, box-shadow 0.18s ease;
            text-decoration: none;
            box-shadow: 0 16px 24px rgba(10, 10, 10, 0.25);
            margin-top: 1rem;
        }

        .btn-primary:hover {
            background: #000;
            transform: translateY(-2px);
            box-shadow: 0 20px 32px rgba(10, 10, 10, 0.3);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        /* Question Card */
        .question-card {
            background: white;
            border-radius: calc(var(--radius) * 2);
            padding: 2.5rem;
            box-shadow: 0 24px 48px rgba(10, 10, 10, 0.12);
            border: 1px solid rgba(17, 17, 17, 0.06);
        }

        .question-header {
            margin-bottom: 2rem;
        }

        .question-text {
            font-size: 1.375rem;
            font-weight: 600;
            color: var(--color-black);
            line-height: 1.3;
            margin-bottom: 0.75rem;
        }

        .question-helper-text {
            font-size: 1rem;
            color: var(--color-gray-600);
            line-height: 1.6;
        }

        /* Options */
        .options {
            display: grid;
            gap: 0.875rem;
        }

        .option {
            position: relative;
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.25rem 1.125rem;
            border-radius: var(--radius);
            border: 2px solid var(--color-gray-200);
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .option:hover {
            border-color: var(--color-gray-400);
            background: var(--color-gray-50);
        }

        .option.selected {
            border-color: var(--color-black);
            background: var(--color-gray-50);
        }

        .option-radio {
            width: 22px;
            height: 22px;
            border-radius: 999px;
            border: 2px solid var(--color-gray-400);
            background: white;
            flex-shrink: 0;
            transition: all 0.2s ease;
        }

        .option.selected .option-radio {
            border-color: var(--color-black);
            border-width: 6px;
        }

        .option-label {
            flex: 1;
            display: grid;
            gap: 0.25rem;
        }

        .option-label-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--color-black);
        }

        .option-label-text {
            font-size: 0.9375rem;
            color: var(--color-gray-600);
            line-height: 1.5;
        }

        /* Text Input */
        .form-group {
            margin-top: 1rem;
        }

        .form-input,
        .form-textarea {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid var(--color-gray-200);
            border-radius: var(--radius);
            font-size: 1rem;
            font-family: var(--font-base);
            color: var(--color-black);
            background: white;
            transition: all 0.2s ease;
        }

        .form-input:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--color-black);
            box-shadow: 0 0 0 3px rgba(10, 10, 10, 0.05);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Contact Form */
        .contact-grid {
            display: grid;
            gap: 1rem;
        }

        .form-select {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid var(--color-gray-200);
            border-radius: var(--radius);
            font-size: 1rem;
            font-family: var(--font-base);
            color: var(--color-black);
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--color-black);
        }

        .checkbox-wrapper {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .checkbox-input {
            width: 22px;
            height: 22px;
            flex-shrink: 0;
            cursor: pointer;
        }

        .checkbox-label {
            font-size: 0.9375rem;
            color: var(--color-gray-700);
            line-height: 1.6;
        }

        .checkbox-label a {
            color: var(--color-black);
            text-decoration: underline;
        }

        /* Navigation Buttons */
        .btn-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            flex: 1;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem 1.75rem;
            font-size: 1rem;
            font-weight: 500;
            font-family: var(--font-base);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-secondary {
            background: var(--color-gray-100);
            color: var(--color-black);
        }

        .btn-secondary:hover {
            background: var(--color-gray-200);
        }

        .btn-submit {
            background: var(--color-black);
            color: white;
        }

        .btn-submit:hover {
            background: #000;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Results Screen */
        .results-screen {
            padding: 3rem 0;
        }

        .results-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .results-score-display {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 180px;
            height: 180px;
            border-radius: 999px;
            background: linear-gradient(135deg, var(--color-highlight) 0%, #5ac4b0 100%);
            box-shadow: 0 24px 48px rgba(112, 220, 196, 0.35);
            margin-bottom: 2rem;
        }

        .results-score-number {
            font-size: 3.5rem;
            font-weight: 700;
            color: var(--color-black);
        }

        .results-title {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .results-category {
            display: inline-block;
            padding: 0.5rem 1.25rem;
            border-radius: 999px;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .results-category.high {
            background: #dcfce7;
            color: #166534;
        }

        .results-category.medium {
            background: #fef3c7;
            color: #854d0e;
        }

        .results-category.low {
            background: #fee2e2;
            color: #991b1b;
        }

        .results-interpretation {
            font-size: 1.125rem;
            color: var(--color-gray-700);
            line-height: 1.7;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Details Section */
        .details-section {
            margin-top: 4rem;
        }

        .details-category {
            margin-bottom: 3rem;
        }

        .details-category-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--color-gray-200);
        }

        .details-category-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .details-category-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 999px;
            font-size: 1rem;
            font-weight: 700;
        }

        .details-category-badge.positive {
            background: #dcfce7;
            color: #166534;
        }

        .details-category-badge.neutral {
            background: #fef3c7;
            color: #854d0e;
        }

        .details-category-badge.critical {
            background: #fee2e2;
            color: #991b1b;
        }

        .detail-card {
            background: white;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
            border: 1px solid var(--color-gray-200);
        }

        .detail-question {
            font-size: 1.0625rem;
            font-weight: 600;
            color: var(--color-black);
            margin-bottom: 0.75rem;
        }

        .detail-row {
            display: grid;
            gap: 0.5rem;
            font-size: 0.9375rem;
            line-height: 1.6;
        }

        .detail-row strong {
            color: var(--color-black);
        }

        .detail-answer {
            color: var(--color-gray-700);
        }

        .detail-rationale {
            color: var(--color-gray-600);
        }

        .detail-score {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.375rem 0.875rem;
            border-radius: 999px;
            background: var(--color-gray-100);
            font-weight: 600;
            color: var(--color-black);
            margin-top: 0.75rem;
        }

        /* CTA Section */
        .cta-section {
            margin-top: 4rem;
            padding: 3rem;
            background: var(--color-gray-50);
            border-radius: calc(var(--radius) * 2);
            text-align: center;
        }

        .cta-title {
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .cta-text {
            font-size: 1.125rem;
            color: var(--color-gray-700);
            line-height: 1.7;
            margin-bottom: 2rem;
        }

        /* Hidden Class */
        .hidden {
            display: none !important;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--color-gray-600);
        }

        /* Mobile Responsive */
        @media (max-width: 640px) {
            .welcome-screen,
            .question-card {
                padding: 2rem 1.5rem;
            }

            .question-text {
                font-size: 1.25rem;
            }

            .btn-group {
                flex-direction: column;
            }

            .results-score-display {
                width: 150px;
                height: 150px;
            }

            .results-score-number {
                font-size: 3rem;
            }
        }

        @media (max-width: 375px) {
            .welcome-screen,
            .question-card {
                padding: 1.5rem 1.25rem;
            }

            .question-text {
                font-size: 1.125rem;
            }
        }
    </style>
</head>
<body>
    <!-- Progress Bar -->
    <div class="progress-wrapper hidden" id="progressWrapper">
        <div class="progress-container">
            <div class="progress-overall-track">
                <div class="progress-overall-fill" id="progressBar" style="width: 0%"></div>
            </div>
            <div class="progress-labels">
                <span id="progressText">Frage 1 von 14</span>
                <strong id="progressPercent">0%</strong>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <!-- Welcome Screen -->
            <div id="welcomeScreen" class="welcome-shell">
                <div class="welcome-screen">
                    <div class="welcome-content">
                        <h1 class="welcome-title">Malta Eignungscheck</h1>
                        <p class="welcome-text">
                            Finden Sie heraus, ob Malta der richtige Standort für Sie und Ihr Unternehmen ist.
                            Beantworten Sie 14 kurze Fragen und erhalten Sie eine detaillierte Auswertung Ihres Eignungsgrades.
                        </p>
                        <ul class="welcome-features">
                            <li>12-14 Minuten für Ihre personalisierte Analyse</li>
                            <li>Detaillierte Auswertung mit Eignungsgrad (0-100%)</li>
                            <li>Konkrete Handlungsempfehlungen</li>
                            <li>Kostenfrei und unverbindlich</li>
                        </ul>
                        <button class="btn-primary" onclick="startAssessment()">
                            Jetzt starten →
                        </button>
                    </div>
                </div>
            </div>

            <!-- Question Screen -->
            <div id="questionScreen" class="hidden">
                <div class="question-card" id="questionCard">
                    <!-- Question content will be injected here -->
                </div>

                <!-- Navigation Buttons -->
                <div class="btn-group">
                    <button class="btn btn-secondary" id="backBtn" onclick="previousQuestion()">
                        ← Zurück
                    </button>
                    <button class="btn btn-submit" id="nextBtn" onclick="nextQuestion()" disabled>
                        Weiter →
                    </button>
                </div>
            </div>

            <!-- Results Screen -->
            <div id="resultsScreen" class="hidden">
                <div class="results-screen">
                    <!-- Results will be injected here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const CONFIG = {
            webhookUrl: 'https://brixon.app.n8n.cloud/webhook/malta-eignungscheck',
        };

        // Questions Data
        const questions = [
            {
                id: 'q001',
                text: 'Wie sind Sie aktuell beschäftigt?',
                helper: 'Wählen Sie aus den untenstehenden Optionen aus.',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: 'Angestellter', description: 'Befindlich in einem festen Arbeitsverhältnis.', score: 5 },
                    { value: '2', label: 'Einzelunternehmer', description: 'Ohne Festanstellung, z.B. als Freiberufler und ggf. mit wechselnden Auftraggebern.', score: 7 },
                    { value: '3', label: 'Unternehmer', description: 'Inhaber eines Unternehmens mit mindestens einem Mitarbeiter in Festanstellung.', score: 10 }
                ]
            },
            {
                id: 'q002',
                text: 'Welche Rechtsform hat Ihr Unternehmen?',
                helper: 'Die angegebenen Gesellschaftstypen sind nur Beispiele.',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: 'Einzelunternehmen', description: 'Einzelkaufleute, Freiberufler, Kleingewerbe', score: 3 },
                    { value: '2', label: 'Personengesellschaft', description: 'GbR, OHG, KG', score: 5 },
                    { value: '3', label: 'Kapitalgesellschaft', description: 'GmbH, UG, AG, Limited', score: 10 },
                    { value: '4', label: 'Ohne Unternehmen', description: '', score: 2 }
                ]
            },
            {
                id: 'q003',
                text: 'Müssen Sie für Kundentermine physisch vor Ort sein?',
                helper: 'Wählen Sie aus den untenstehenden Optionen.',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: 'Ja', description: '', score: 2 },
                    { value: '2', label: 'Nein', description: '', score: 10 },
                    { value: '3', label: 'Ich habe keine Kundentermine', description: '', score: 8 }
                ]
            },
            {
                id: 'q004',
                text: 'In welcher Branche sind Sie tätig?',
                helper: '',
                type: 'text',
                required: false,
                score: 0
            },
            {
                id: 'q005',
                text: 'Können Sie sich vorstellen, im Ausland zu leben?',
                helper: 'Sofern Sie bereits im Ausland leben, klicken Sie auf "Ja".',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: 'Ja', description: '', score: 10 },
                    { value: '2', label: 'Nein', description: '', score: 0 },
                    { value: '3', label: 'Ich weiß nicht', description: '', score: 3 }
                ]
            },
            {
                id: 'q006',
                text: 'Können Sie sich vorstellen, in Malta zu leben?',
                helper: 'Sofern Sie bereits in Malta leben, klicken Sie auf "Ja".',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: 'Ja', description: '', score: 10 },
                    { value: '2', label: 'Nein', description: '', score: 0 },
                    { value: '3', label: 'Ich weiß nicht', description: '', score: 4 }
                ]
            },
            {
                id: 'q007',
                text: 'Angaben zum perspektivischen Umsatz Ihrer Unternehmung',
                helper: '',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: '< 100.000€', description: 'jährlich', score: 3 },
                    { value: '2', label: '100.000€ - 300.000€', description: 'jährlich', score: 6 },
                    { value: '3', label: '300.000€ - 900.000€', description: 'jährlich', score: 9 },
                    { value: '4', label: '> 900.000€', description: 'jährlich', score: 10 }
                ]
            },
            {
                id: 'q008',
                text: 'Angaben zum perspektivischen Gewinn Ihrer Unternehmung',
                helper: '',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: '< 100.000€', description: 'jährlich', score: 3 },
                    { value: '2', label: '100.000€ - 300.000€', description: 'jährlich', score: 6 },
                    { value: '3', label: '300.000€ - 900.000€', description: 'jährlich', score: 9 },
                    { value: '4', label: '> 900.000€', description: 'jährlich', score: 10 }
                ]
            },
            {
                id: 'q009',
                text: 'Ist Ihre Unternehmung an Ihr Wohnsitzland gebunden oder international?',
                helper: 'Diese Frage setzt voraus, dass Ihre Unternehmung aktuell nicht von Malta aus operiert.',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: 'Im Wohnsitzland', description: 'Beispiele: Bäcker, lokale Autohändler, Einzelhändler', score: 1 },
                    { value: '2', label: 'Eher im Wohnsitzland', description: 'Beispiele: Rechtsanwälte, Fitness-Trainer, FBA-Händler', score: 4 },
                    { value: '3', label: 'Eher international', description: 'Fotografen, Unternehmensberater, Architekten', score: 8 },
                    { value: '4', label: 'Sehr international', description: 'Marketer, Software-Entwickler, Autoren', score: 10 }
                ]
            },
            {
                id: 'q010',
                text: 'Wie weit ist Ihre Unternehmung fortgeschritten?',
                helper: '',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: '0-10%', description: 'Es handelt sich um eine vollständig neue Unternehmung', score: 4 },
                    { value: '2', label: '10-30%', description: 'Die Unternehmung ist getestet und ich würde nun gerne starten.', score: 6 },
                    { value: '3', label: '>90% - teilweise verlegen', description: 'Meine Unternehmung besteht seit geraumer Zeit, ich könnte mir vorstellen, einen Teil ins Ausland zu verlegen.', score: 8 },
                    { value: '4', label: '>90% - komplett verlegen', description: 'Meine Unternehmung besteht seit geraumer Zeit, ich könnte mir vorstellen, alles ins Ausland zu verlegen.', score: 10 }
                ]
            },
            {
                id: 'q011',
                text: 'Wie ist Ihre Unternehmung physisch aufgestellt?',
                helper: 'Notwendige Büroräume, Mitarbeiter, physische Komponenten.',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: 'Hohe Physis', description: 'Meine Unternehmung beinhaltet essentielle physische Komponenten. Beispiele: Logistik, Herstellung', score: 2 },
                    { value: '2', label: 'Eher hohe Physis', description: 'Meine Unternehmung beinhaltet nur bedingt physische Komponenten. Beispiel: Lagerräume, Büroräume', score: 5 },
                    { value: '3', label: 'Eher geringe Physis', description: 'Meine Unternehmung setzt diverse Räumlichkeiten voraus. Beispiel: Büroräume', score: 7 },
                    { value: '4', label: 'Keine bis geringe Physis', description: 'Meine Unternehmung beinhaltet keine physischen Komponenten. Beispiele: Digitale Nomaden, Homeoffice', score: 10 }
                ]
            },
            {
                id: 'q012',
                text: 'Könnte der Standort Malta für Sie interessant sein?',
                helper: 'Wählen Sie die zutreffendste Antwort.',
                type: 'single_choice',
                required: true,
                options: [
                    { value: '1', label: 'Ja', description: 'Ich stelle mir das Leben in Malta schön vor', score: 10 },
                    { value: '2', label: 'Ja, für meine Unternehmung', description: 'Für meine Unternehmung könnte Malta Sinn machen.', score: 8 },
                    { value: '3', label: 'Naja', description: 'Wenn dann würden mich nur niedrige Steuern nach Malta ziehen.', score: 4 },
                    { value: '4', label: 'Nein', description: 'Der Standort Malta reizt mich überhaupt nicht.', score: 0 }
                ]
            },
            {
                id: 'q013',
                text: 'Optional: Beschreiben Sie Ihre Situation kurz mit einigen Worten!',
                helper: '',
                type: 'textarea',
                required: false,
                score: 0
            },
            {
                id: 'q014',
                text: 'Optional: Was Sie uns sonst noch wissen lassen möchten',
                helper: '',
                type: 'textarea',
                required: false,
                score: 0
            },
            {
                id: 'q015_contact',
                text: 'Der letzte Schritt',
                helper: 'Geben Sie Ihre Kontaktdaten an, damit wir Ihnen den Zugang zu Ihrem Ergebnis zusenden können.',
                type: 'contact',
                required: true
            }
        ];

        // State
        let currentQuestionIndex = 0;
        let answers = {};
        let userContact = {};

        // Initialize
        function startAssessment() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('questionScreen').classList.remove('hidden');
            document.getElementById('progressWrapper').classList.remove('hidden');
            renderQuestion();
        }

        // Render Question
        function renderQuestion() {
            const question = questions[currentQuestionIndex];
            const card = document.getElementById('questionCard');

            updateProgress();
            updateNavigationButtons();

            let html = `
                <div class="question-header">
                    <h3 class="question-text">${question.text}</h3>
                    ${question.helper ? `<p class="question-helper-text">${question.helper}</p>` : ''}
                </div>
            `;

            if (question.type === 'single_choice') {
                html += '<div class="options">';
                question.options.forEach(option => {
                    const isSelected = answers[question.id] === option.value;
                    html += `
                        <div class="option ${isSelected ? 'selected' : ''}" onclick="selectOption('${question.id}', '${option.value}')">
                            <div class="option-radio"></div>
                            <div class="option-label">
                                <div class="option-label-title">${option.label}</div>
                                ${option.description ? `<div class="option-label-text">${option.description}</div>` : ''}
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            } else if (question.type === 'text') {
                html += `
                    <div class="form-group">
                        <input type="text" class="form-input" id="input_${question.id}"
                            placeholder="Ihre Antwort..."
                            value="${answers[question.id] || ''}"
                            onchange="updateTextAnswer('${question.id}', this.value)">
                    </div>
                `;
            } else if (question.type === 'textarea') {
                html += `
                    <div class="form-group">
                        <textarea class="form-textarea" id="input_${question.id}"
                            placeholder="Optionale Angaben..."
                            onchange="updateTextAnswer('${question.id}', this.value)">${answers[question.id] || ''}</textarea>
                    </div>
                `;
            } else if (question.type === 'contact') {
                html += `
                    <div class="contact-grid">
                        <div class="form-group">
                            <select class="form-select" id="geschlecht" required>
                                <option value="">Bitte wählen Sie</option>
                                <option value="Frau" ${userContact.geschlecht === 'Frau' ? 'selected' : ''}>Frau</option>
                                <option value="Herr" ${userContact.geschlecht === 'Herr' ? 'selected' : ''}>Herr</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-input" id="vorname"
                                placeholder="Ihr Vorname" value="${userContact.vorname || ''}" required>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-input" id="nachname"
                                placeholder="Ihr Nachname" value="${userContact.nachname || ''}" required>
                        </div>
                        <div class="form-group">
                            <input type="email" class="form-input" id="email"
                                placeholder="Ihre Email-Adresse" value="${userContact.email || ''}" required>
                        </div>
                        <div class="checkbox-wrapper">
                            <input type="checkbox" class="checkbox-input" id="terms" ${userContact.terms ? 'checked' : ''}>
                            <label class="checkbox-label" for="terms">
                                Ich stimme der <a href="https://www.drwerner.com/de/other/privacy-policy/" target="_blank">Datenschutzerklärung</a> zu.
                                Ich stimme außerdem zu, E-Mails im Zusammenhang mit dem Malta Eignungscheck zu erhalten.
                            </label>
                        </div>
                    </div>
                `;
            }

            card.innerHTML = html;
        }

        // Select Option
        function selectOption(questionId, value) {
            answers[questionId] = value;
            renderQuestion();
        }

        // Update Text Answer
        function updateTextAnswer(questionId, value) {
            answers[questionId] = value;
            updateNavigationButtons();
        }

        // Update Progress
        function updateProgress() {
            const totalQuestions = questions.length;
            const progress = ((currentQuestionIndex + 1) / totalQuestions) * 100;

            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('progressText').textContent = `Frage ${currentQuestionIndex + 1} von ${totalQuestions}`;
            document.getElementById('progressPercent').textContent = `${Math.round(progress)}%`;
        }

        // Update Navigation Buttons
        function updateNavigationButtons() {
            const question = questions[currentQuestionIndex];
            const nextBtn = document.getElementById('nextBtn');
            const backBtn = document.getElementById('backBtn');

            // Back button
            backBtn.style.display = currentQuestionIndex === 0 ? 'none' : 'flex';

            // Next button
            let isValid = false;

            if (question.type === 'contact') {
                const geschlecht = document.getElementById('geschlecht')?.value;
                const vorname = document.getElementById('vorname')?.value;
                const nachname = document.getElementById('nachname')?.value;
                const email = document.getElementById('email')?.value;
                const terms = document.getElementById('terms')?.checked;

                isValid = geschlecht && vorname && nachname && email && terms;

                if (currentQuestionIndex === questions.length - 1) {
                    nextBtn.textContent = 'Jetzt Eignungsgrad erfahren';
                }
            } else if (question.required) {
                isValid = !!answers[question.id];
            } else {
                isValid = true;
            }

            nextBtn.disabled = !isValid;
        }

        // Previous Question
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestion();
            }
        }

        // Next Question
        function nextQuestion() {
            const question = questions[currentQuestionIndex];

            // Save contact info if on contact page
            if (question.type === 'contact') {
                userContact = {
                    geschlecht: document.getElementById('geschlecht').value,
                    vorname: document.getElementById('vorname').value,
                    nachname: document.getElementById('nachname').value,
                    email: document.getElementById('email').value,
                    terms: document.getElementById('terms').checked
                };
            }

            // If last question, calculate and show results
            if (currentQuestionIndex === questions.length - 1) {
                calculateAndShowResults();
            } else {
                currentQuestionIndex++;
                renderQuestion();
            }
        }

        // Calculate Score
        function calculateScore() {
            let totalScore = 0;
            let maxScore = 0;
            let detailedResults = [];

            questions.forEach(q => {
                if (q.type === 'single_choice' && q.options) {
                    const selectedValue = answers[q.id];
                    const selectedOption = q.options.find(opt => opt.value === selectedValue);

                    if (selectedOption) {
                        const score = selectedOption.score;
                        totalScore += score;

                        // Categorize based on score
                        let category = 'neutral';
                        if (score >= 8) category = 'positive';
                        else if (score <= 3) category = 'critical';

                        detailedResults.push({
                            questionId: q.id,
                            questionText: q.text,
                            answer: selectedOption.label,
                            answerDescription: selectedOption.description || '',
                            score: score,
                            category: category
                        });
                    }

                    // Calculate max possible score
                    const maxOptionScore = Math.max(...q.options.map(opt => opt.score));
                    maxScore += maxOptionScore;
                }
            });

            // Convert to percentage (0-100)
            const percentage = Math.round((totalScore / maxScore) * 100);

            return {
                percentage,
                totalScore,
                maxScore,
                detailedResults
            };
        }

        // Calculate and Show Results
        async function calculateAndShowResults() {
            const scoreData = calculateScore();
            const percentage = scoreData.percentage;

            // Determine category and interpretation
            let category, categoryLabel, interpretation;

            if (percentage < 30) {
                category = 'low';
                categoryLabel = 'Eher ungeeignet';
                interpretation = 'Malta eignet sich eher nicht für Sie. Ihre Unternehmung oder persönliche Situation macht einen Umzug nach Malta aktuell schwierig. Wir empfehlen Ihnen, die Rahmenbedingungen zu optimieren oder alternative Standorte in Betracht zu ziehen.';
            } else if (percentage < 60) {
                category = 'medium';
                categoryLabel = 'Bedingt geeignet';
                interpretation = 'Malta eignet sich nur unter Umständen für Sie. Es gibt sowohl positive als auch kritische Faktoren zu berücksichtigen. Eine detaillierte Beratung kann klären, ob Malta für Sie der richtige Schritt ist.';
            } else {
                category = 'high';
                categoryLabel = 'Sehr geeignet';
                interpretation = 'Malta eignet sich für Sie! Ihre Unternehmung und persönliche Situation bieten hervorragende Voraussetzungen für einen erfolgreichen Standortwechsel nach Malta. Wir empfehlen Ihnen eine persönliche Beratung, um die nächsten Schritte zu planen.';
            }

            // Categorize detailed results
            const positiveDetails = scoreData.detailedResults.filter(r => r.category === 'positive');
            const neutralDetails = scoreData.detailedResults.filter(r => r.category === 'neutral');
            const criticalDetails = scoreData.detailedResults.filter(r => r.category === 'critical');

            // Send webhook
            await sendWebhook({
                timestamp: new Date().toISOString(),
                contact: userContact,
                answers: answers,
                score: {
                    percentage: percentage,
                    totalScore: scoreData.totalScore,
                    maxScore: scoreData.maxScore,
                    category: category
                },
                interpretation: interpretation,
                detailedResults: scoreData.detailedResults
            });

            // Render results
            renderResults(percentage, category, categoryLabel, interpretation, positiveDetails, neutralDetails, criticalDetails);
        }

        // Render Results
        function renderResults(percentage, category, categoryLabel, interpretation, positiveDetails, neutralDetails, criticalDetails) {
            document.getElementById('questionScreen').classList.add('hidden');
            document.getElementById('progressWrapper').classList.add('hidden');
            document.getElementById('resultsScreen').classList.remove('hidden');

            const resultsContainer = document.querySelector('.results-screen');

            let html = `
                <div class="results-header">
                    <div class="results-score-display">
                        <span class="results-score-number">${percentage}%</span>
                    </div>
                    <h2 class="results-title">Ihr Ergebnis: ${userContact.vorname} ${userContact.nachname}</h2>
                    <span class="results-category ${category}">${categoryLabel}</span>
                    <p class="results-interpretation">${interpretation}</p>
                </div>

                ${positiveDetails.length > 0 ? `
                <div class="details-section">
                    <div class="details-category">
                        <div class="details-category-header">
                            <h3 class="details-category-title">Positive Faktoren</h3>
                            <span class="details-category-badge positive">${positiveDetails.length}</span>
                        </div>
                        ${positiveDetails.map((detail, index) => `
                            <div class="detail-card">
                                <h4 class="detail-question">Frage ${questions.findIndex(q => q.id === detail.questionId) + 1}: ${detail.questionText}</h4>
                                <div class="detail-row">
                                    <div><strong>Ihre Antwort:</strong> ${detail.answer}</div>
                                    ${detail.answerDescription ? `<div class="detail-rationale">${detail.answerDescription}</div>` : ''}
                                    <div class="detail-score">Bewertung: ${detail.score * 10}%</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}

                ${neutralDetails.length > 0 ? `
                <div class="details-section">
                    <div class="details-category">
                        <div class="details-category-header">
                            <h3 class="details-category-title">Neutrale Faktoren</h3>
                            <span class="details-category-badge neutral">${neutralDetails.length}</span>
                        </div>
                        ${neutralDetails.map((detail, index) => `
                            <div class="detail-card">
                                <h4 class="detail-question">Frage ${questions.findIndex(q => q.id === detail.questionId) + 1}: ${detail.questionText}</h4>
                                <div class="detail-row">
                                    <div><strong>Ihre Antwort:</strong> ${detail.answer}</div>
                                    ${detail.answerDescription ? `<div class="detail-rationale">${detail.answerDescription}</div>` : ''}
                                    <div class="detail-score">Bewertung: ${detail.score * 10}%</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}

                ${criticalDetails.length > 0 ? `
                <div class="details-section">
                    <div class="details-category">
                        <div class="details-category-header">
                            <h3 class="details-category-title">Kritische Faktoren</h3>
                            <span class="details-category-badge critical">${criticalDetails.length}</span>
                        </div>
                        ${criticalDetails.map((detail, index) => `
                            <div class="detail-card">
                                <h4 class="detail-question">Frage ${questions.findIndex(q => q.id === detail.questionId) + 1}: ${detail.questionText}</h4>
                                <div class="detail-row">
                                    <div><strong>Ihre Antwort:</strong> ${detail.answer}</div>
                                    ${detail.answerDescription ? `<div class="detail-rationale">${detail.answerDescription}</div>` : ''}
                                    <div class="detail-score">Bewertung: ${detail.score * 10}%</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}

                <div class="cta-section">
                    <h3 class="cta-title">Nächste Schritte</h3>
                    <p class="cta-text">
                        Möchten Sie mehr über Malta als Unternehmensstandort erfahren?
                        Vereinbaren Sie ein kostenloses Erstgespräch mit unseren Malta-Experten.
                    </p>
                    <button class="btn-primary" onclick="window.open('https://www.drwerner.com/de/contact/', '_blank')">
                        Jetzt Beratungsgespräch vereinbaren →
                    </button>
                </div>
            `;

            resultsContainer.innerHTML = html;
        }

        // Send Webhook
        async function sendWebhook(data) {
            try {
                await fetch(CONFIG.webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
            } catch (error) {
                console.error('Webhook error:', error);
            }
        }

        // Add event listeners for contact form inputs
        document.addEventListener('input', (e) => {
            if (['geschlecht', 'vorname', 'nachname', 'email', 'terms'].includes(e.target.id)) {
                updateNavigationButtons();
            }
        });

        document.addEventListener('change', (e) => {
            if (['geschlecht', 'vorname', 'nachname', 'email', 'terms'].includes(e.target.id)) {
                updateNavigationButtons();
            }
        });
    </script>
</body>
</html>
